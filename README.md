# terraform-ansible-inventory CLI

A high-performance, zero-dependency Go command-line tool for building complete Ansible inventories from Terraform state generated by the `ansible/ansible` provider.

For extensive usage guides see the [docs directory](docs/) which also powers the GitHub Pages site.

---

## ğŸ” Features

- **Streaming JSON parsing**: Handles files of 20M+ lines and 500+ levels deep without blowing memory.
- **Flexible output formats**: `yaml`, `ini`, or `json`.
- **Provider aware**: understands `ansible_host` and `ansible_group` resources including variables and group hierarchy.
- **Built-in IP/CIDR handling**: Strips CIDR suffix for `ansible_host` variables.
- **Clean CLI interface**: Automatic `--help` message, sensible defaults.
- **CI/CD ready**: Smoke-test JSON example and GitHub Actions for build & test.

---

## ğŸ“¦ Installation

```bash
# Clone the repo:
git clone https://github.com/HilkopterBob/terraform-ansible-inventory.git
cd terraform-ansible-inventory

# Build the binary:
go build -o terraform-ansible-inventory ./main.go

# (Optional) Install globally:
go install github.com/HilkopterBob/terraform-ansible-inventory@latest
```

---

## ğŸš€ Usage

```
$ terraform-ansible-inventory --help
Usage of terraform-ansible-inventory:
  -format string
        Output format: yaml, ini, json (default "yaml")
  -input string
        Path to input JSON file (or '-' for stdin)
```

All flags can be abbreviated:

- `-i` or `--input`
- `-f` or `--format`

### Examples

Assume `state.json` is your Terraform state created with the `ansible/ansible` provider:

```bash
# 1) YAML inventory
terraform-ansible-inventory -i state.json -f yaml > inventory.yml

# 2) INI inventory
terraform-ansible-inventory -i state.json -f ini > inventory.ini

# 3) JSON machine readable form
terraform-ansible-inventory -i state.json -f json > inventory.json
```


## ğŸ”§ Contributing

1. Fork & clone the repo
2. Create a feature branch `git checkout -b feature/myfeature`
3. Add tests under `internal/*_test.go`
4. Ensure all tests pass
5. Submit a PR

---

## ğŸ“„ License

Apache-2.0 Â© Nick von Podewils

